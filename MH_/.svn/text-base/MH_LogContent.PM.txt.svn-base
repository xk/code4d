  //@use:  // MH_LogContent ($SubmitDate_d:date ;$SubmitTime_h:time ;$SubmitBy_t:txt ;$MethodName_t:txt ;$MethodContent_t:txt)If (False)  //=================  //@FUNCTION: MH_LogContent  //@brief:   // This method opens an external database using SQL and stores the  // content of the method. Saves the method content in an external text file.  //  // NOTE 1  //  Not 100% safe, as a Method and a Project Form method can have the same name  //  If a method "MyDialog" and a form "MyDialog" both exist,  //  there will be a collision in the method history  //   //  Method name received for the "Project Form Method" will be the same as the "Project Method"  //  I can't detemine if a method is a "Project Form Method" or a "Project Method"  //  // NOTE 2  // To determine the type, I assume there is not "." in a form name  // It will only affect predetrmined querys in the HistoryManager dialog  //=================  //@author: jpupier  //@modified_by:  //---------  //@version: 1.0  //@date: 22 oct, 2010  //=================  //@SVN_Folder: MH_/Else   //=================C_DATE($1;$SubmitDate_d)C_TIME($2;$SubmitTime_h)C_TEXT($3;$SubmitBy_t)C_TEXT($4;$MethodName_t)C_TEXT($5;$MethodContent_t)  //---------C_LONGINT($ParamCount_l)$ParamCount_l:=Count parametersC_LONGINT($MethodLen_l)C_TEXT($MethodType_t)C_TEXT($External_DB_SQLPath_t)C_BOOLEAN($ContentChanged_b)C_TEXT($svn_enabled_t;$svn_root_t;$host_svn_root_t;$filepath_t;$MethodSVNfolder_t;$ActualPath_t)  //  //=================End if   //=================If ($ParamCount_l>=5)$SubmitDate_d:=$1$SubmitTime_h:=$2$SubmitBy_t:=$3$MethodName_t:=$4$MethodContent_t:=$5  //$MethodLen_l:=Length($MethodContent_t)$MethodType_t:=MH_Get_Method_Type ($MethodName_t)$MethodSVNfolder_t:=MH_Get_Method_SVNFolder ($MethodContent_t)  //C_TEXT($MH_Enabled_t;$SVN_Enabled_t)MH_Prefs ("get";"method_history";->$MH_Enabled_t)MH_Prefs ("get";"svn";->$SVN_Enabled_t)  //  // ========= Create MH Record ===========If ($MH_Enabled_t="enabled")MH_Init_ExternalDB $ContentChanged_b:=(MH_Get_LatestVersion_Content ($MethodName_t)#$MethodContent_t)If ($ContentChanged_b)$External_DB_SQLPath_t:=MH_Get_HistoPath Begin SQLUSE DATABASE DATAFILE :$External_DB_SQLPath_t;INSERT INTO METHOD_HISTORY (SubmitDate, SubmitTime, SubmitBy, MethodName, MethodContent, MethodType, MethodLen) VALUES (:$SubmitDate_d, :$SubmitTime_h, :$SubmitBy_t, :$MethodName_t, :$MethodContent_t, :$MethodType_t, :$MethodLen_l);USE LOCAL DATABASE DEFAULT;End SQLEnd if End if   //  // ========= Create SVN File ===========If ($SVN_Enabled_t="enabled")MH_Prefs ("get";"svn_local";->$svn_root_t)If (Test path name($svn_root_t)=Is a directory)$host_svn_root_t:=$svn_root_t+MH_Get_Hostname +Folder separatorIf (Test path name($host_svn_root_t)#Is a directory)CREATE FOLDER($host_svn_root_t)End if $ActualPath_t:=MH_CreateSVN_Subfolder ($host_svn_root_t;$MethodSVNfolder_t)If (Test path name($ActualPath_t)=Is a directory)$Filepath_t:=$ActualPath_t+$MethodName_t+"."+$MethodType_t+".txt"TEXT_Text_to_Document ($filepath_t;$MethodContent_t)End if End if End if End if   //=================  // eom