  //@use:  // FILE_Get_FPaths_HDocuments ($Path:txt ;$TxtArrayPtr:ptr ; {MaxDepth:l}) -> Path count:lIf (False)  //=================  //@FUNCTION: FILE_Get_FPaths_HDocuments  //@brief: Returns full paths for folders hierarchically within specified folder to specified depth  //=================  //@params:  // $0 is number of full paths returned  // $1 is full path of target source folder  // $2 is referenced text array to hold full paths  // $3 is depth to go into target source folder  //   = MAXLONG for unlimited  //=================  //@author: jpupier  //@modified_by:  //---------  //@version: 1.0  //@date: 22 oct, 2010  //=================  //@SVN_Folder: MH_/Else   //=================C_LONGINT($0;$ReturnedPathsCount_l)$ReturnedPathsCount_l:=0C_TEXT($1;$SourceFullPath_t)$SourceFullPath_t:=$1C_POINTER($2;$FullFilePaths_at_p)$FullFilePaths_at_p:=$2C_LONGINT($3;$MaxDepth_l)$MaxDepth_l:=MAXLONGIf (Count parameters>=3)$MaxDepth_l:=$3End if   //---------C_LONGINT($ParamCount_l)C_TEXT($DirectorySymbol_t)C_LONGINT($StartIndex_l)C_LONGINT($EndIndex_l)C_LONGINT($CurrentDepth_l)C_BOOLEAN($NotAtBottom_b)C_LONGINT($CurrentScanIndex_l)C_LONGINT($NewFolderCount_l)C_LONGINT($CurrentNewFolderIndex_l)  //$ParamCount_l:=Count parameters$DirectorySymbol_t:=Folder separator  //=================End if   //============================================================  //clear and seed result arrayDELETE FROM ARRAY($FullFilePaths_at_p->;1;Size of array($FullFilePaths_at_p->))APPEND TO ARRAY($FullFilePaths_at_p->;$SourceFullPath_t)  //prep index ranges$StartIndex_l:=1$EndIndex_l:=1  //prep current depth$CurrentDepth_l:=1  //prep bottom detection$NotAtBottom_b:=True  //  //handle depth loopingWhile (($CurrentDepth_l<=$MaxDepth_l) & ($NotAtBottom_b))  //assume bottom hit on this pass$NotAtBottom_b:=False  //------------------------------------------------------------  //loop thru folders at this depthFor ($CurrentScanIndex_l;$StartIndex_l;$EndIndex_l;1)  //get enclosed folders list    ARRAY TEXT($NewFoldersNames_at;0)FOLDER LIST($FullFilePaths_at_p->{$CurrentScanIndex_l};$NewFoldersNames_at)$NewFolderCount_l:=Size of array($NewFoldersNames_at)  //check if new folders foundIf ($NewFolderCount_l#0)  //set flag to indicate not at bottom$NotAtBottom_b:=True  //make new folder names into full pathsFor ($CurrentNewFolderIndex_l;1;$NewFolderCount_l;1)APPEND TO ARRAY($FullFilePaths_at_p->;$FullFilePaths_at_p->{$CurrentScanIndex_l}+$NewFoldersNames_at{$CurrentNewFolderIndex_l}+$DirectorySymbol_t)End for End if End for   //------------------------------------------------------------  //increase depth count$CurrentDepth_l:=$CurrentDepth_l+1  //set next depth index range$StartIndex_l:=$EndIndex_l+1$EndIndex_l:=Size of array($FullFilePaths_at_p->)End while   //  //set full paths count$ReturnedPathsCount_l:=Size of array($FullFilePaths_at_p->)  //  //============================================================  //set return value$0:=$ReturnedPathsCount_l  //eof