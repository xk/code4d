  //@use:  // FILE_Get_FPaths_HDocuments ($Path:txt ;$TxtArrayPtr:ptr ; {MaxDepth:l}) -> Path count:lIf (False)  //=================  //@FUNCTION: FILE_Get_FPaths_HDocuments  //@brief:   //=================  //@author: jpupier  //@modified_by:  //---------  //@version: 1.0  //@date: 22 oct, 2010  //=================  //@SVN_Folder: MH_/Else   //=================C_LONGINT($0;$ReturnedPathsCount_l)$ReturnedPathsCount_l:=0C_TEXT($1;$SourceFullPath_t)$SourceFullPath_t:=$1C_POINTER($2;$FullFilePaths_at_p)$FullFilePaths_at_p:=$2C_LONGINT($3;$MaxDepth_l)$MaxDepth_l:=MAXLONGIf (Count parameters>=3)$MaxDepth_l:=$3End if   //---------C_LONGINT($ParamCount_l)$ParamCount_l:=Count parametersC_LONGINT($LoopFolder_l;$LoopFile_l;$FileCount_l)  //  //=================End if   //=================ARRAY TEXT($FullFolderPaths_at;0)$ReturnedPathsCount_l:=FILE_Get_FPaths_HFolders ($SourceFullPath_t;->$FullFolderPaths_at;$MaxDepth_l)For ($LoopFolder_l;1;$ReturnedPathsCount_l)ARRAY TEXT($FullFilePathsTemp_at;0)DOCUMENT LIST($FullFolderPaths_at{$LoopFolder_l};$FullFilePathsTemp_at)$FileCount_l:=Size of array($FullFilePathsTemp_at)If ($FileCount_l>0)For ($LoopFile_l;1;$FileCount_l)APPEND TO ARRAY($FullFilePaths_at_p->;$FullFolderPaths_at{$LoopFolder_l}+$FullFilePathsTemp_at{$LoopFile_l})End for End if End for $ReturnedPathsCount_l:=Size of array($FullFilePaths_at_p->)  //============================================================  //set return value$0:=$ReturnedPathsCount_l  //eof