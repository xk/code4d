  //@use:  // MH_Dialog_Load_in_LB (private)If (False)  //=================  //@FUNCTION: MH_Dialog_Load_in_LB  //@brief: Load the selection in the LB according to user criteria  //=================  //@author: jpupier  //---------  //@version: 1.0  //@date: 21 may, 2010  //=================  //@SVN_Folder: MH_/Else   //=================C_TEXT($External_DB_SQLPath_t)C_TEXT($Select_t;$Where_t;$Like_t;$OrderBy_t;$Into_t;$Statement_t)C_LONGINT($checkboxSum)  //  //=================End if   //=================C_POINTER($cb_ProjectMethod_p;$cb_ProjectForms_p;$cb_TableForms_p;$cb_Trigger_p;$cb_Compiler_p)$cb_ProjectMethod_p:=OBJECT Get pointer(Object named;"cb_ProjectMethod_o")$cb_ProjectForms_p:=OBJECT Get pointer(Object named;"cb_ProjectForms_o")$cb_TableForms_p:=OBJECT Get pointer(Object named;"cb_TableForms_o")$cb_Trigger_p:=OBJECT Get pointer(Object named;"cb_Trigger_o")$cb_Compiler_p:=OBJECT Get pointer(Object named;"cb_Compiler_o")$checkboxSum:=($cb_ProjectMethod_p->+$cb_ProjectForms_p->+$cb_TableForms_p->+$cb_Trigger_p->+$cb_Compiler_p->)If (Test path name(MH_Get_HistoPath )=Is a document)  // ========= [ Inits ] ============If (True)ARRAY LONGINT(MH_Changelist_al;0)ARRAY DATE(MH_SubmitDate_ad;0)ARRAY LONGINT(MH_SubmitTime_al;0)ARRAY TEXT(MH_SubmitUser_at;0)ARRAY TEXT(MH_MethodName_at;0)ARRAY TEXT(MH_MethodContent_at;0)ARRAY TEXT(MH_MethodType_at;0)ARRAY LONGINT(MH_MethodLen_al;0)$Select_t:=""$Where_t:=""$Like_t:=""$OrderBy_t:=""$Into_t:=""$Statement_t:=""End if   // ========= [ SQL Statement computation ] ============If (True)$Select_t:="SELECT ChangeList, SubmitDate, SubmitTime, SubmitBy, MethodName, MethodContent, MethodType, MethodLen FROM METHOD_HISTORY"If ($checkboxSum=0) | ($checkboxSum=5)  // no particual clauseElse $Where_t:="WHERE MethodType IN ( "If ($cb_ProjectMethod_p->=1)  //"Project Method" or "Project Form Method" $Where_t:=$Where_t+"'PM', "End if If ($cb_ProjectForms_p->=1)  //"Project Form Object Method" $Where_t:=$Where_t+"'PFOM', "End if If ($cb_TableForms_p->=1)  // "Table Form method" & "Table Form Object Method"$Where_t:=$Where_t+"'TFM', 'TFOM', "End if If ($cb_Compiler_p->=1)  // "Compiler method"$Where_t:=$Where_t+"'COMP', "End if If ($cb_Trigger_p->=1)  // "Table trigger"$Where_t:=$Where_t+"'TRIG', "End if $Where_t:=$Where_t+")"$Where_t:=Replace string($Where_t;", )";" )")End if C_POINTER($ptr)C_TEXT($userFilter_t)$ptr:=OBJECT Get pointer(Object named;"MH_Like_t_o")$userFilter_t:=$ptr->If ($userFilter_t#"")$Like_t:="MethodName LIKE '"+$userFilter_t+"%'"If ($Where_t="")$Like_t:="WHERE "+$Like_tElse $Like_t:="AND "+$Like_tEnd if End if   //Case of : (MH_CurrentView_t="FlatView")$OrderBy_t:="ORDER BY ChangeList DESC": (MH_CurrentView_t="RevisionView")$OrderBy_t:="ORDER BY MethodName ASC, ChangeList DESC": (MH_CurrentView_t="UDView")$OrderBy_t:="ORDER BY SubmitBy ASC, SubmitDate DESC , ChangeList DESC": (MH_CurrentView_t="DUView")$OrderBy_t:="ORDER BY SubmitDate DESC, SubmitBy ASC, ChangeList DESC"End case $Into_t:="INTO :MH_Changelist_al, :MH_SubmitDate_ad, :MH_SubmitTime_al, :MH_SubmitUser_at, :MH_MethodName_at, :MH_MethodContent_at, :MH_MethodType_at, :MH_MethodLen_al"$Statement_t:=$Select_t+" "+$Where_t+" "+$Like_t+" "+$OrderBy_t+" "+$Into_tEnd if   //  // ========= [ Do the query ] ============If (True)$External_DB_SQLPath_t:=MH_Get_HistoPath Begin SQLUSE DATABASE DATAFILE :$External_DB_SQLPath_t;EXECUTE IMMEDIATE :$Statement_t;USE LOCAL DATABASE DEFAULT;End SQLEnd if   // Some stuffLISTBOX COLLAPSE(*;"MH_LB_@";True)MH_MethodContent_t:=""MH_MethodName_t:=""End if   //=================  //eom