If (False)  // MATH_Covariance [Antoine Galmiche 07/2002]  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // Rappels mathématiques :  // La covariance est la moyenne des produits des écarts  // Cov(X,Y) = (1/n) x Somme(x-MoyX)(y-MoyY)  // ---------------------------------------------  // MATH_Covariance (->TableauValeurs1; ->TableauValeurs2) -> Numérique  // TableauValeurs1 (Pointeur) Pointeur tableau réel de la série 1  // TableauValeurs2 (Pointeur) Pointeur tableau réel de la série 2  // Résultat (Numérique) Covariance  // ---------------------------------------------  // MATHERROR  // 0 -> Pas d'erreur  // -1 -> Tableaux de taille différente  // -2 -> Tableaux de taille nulle  // ---------------------------------------------  // ATTENTION  // Les deux tableaux doivent impérativement être de même taille  // ---------------------------------------------  // EXEMPLES  // La covariance entre {1,2,3,4} et {5,6,7,8} est 1,25  // La covariance entre {1,2,3,4} et {8,7,6,5} est -1,25  // La covariance entre {1,2,3,4} et {7,5,8,6} est 0  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  // Math's summary  // Covariance is the mean of variances product  // Cov(X,Y) = (1/n) x Somme(x-MoyX)(y-MoyY)  // ---------------------------------------------  // MATH_Covariance (->ValuesArray1; ->ValuesArray2) -> Real  // ValuesArray1 (Pointer) Pointer on real array of serie 1  // ValuesArray2 (Pointer) Pointer on real array of serie 2  // Result (Real) Covariance  // ---------------------------------------------  // MATHERROR  //  0 -> No error  // -1 -> Arrays with different lenght  // -2 -> Empty arrays  // ---------------------------------------------  // WARNING : Arrays must have same lenght  // ---------------------------------------------  // EXEMPLES  // Covariance between {1,2,3,4} and {5,6,7,8} is 1,25  // Covariance between {1,2,3,4} and {8,7,6,5} is -1,25  // Covariance between {1,2,3,4} and {7,5,8,6} is 0  // ------------------------------------------------------  //  (translation : BE 03-2010)End if   //@SVN_Folder: MATH_/C_LONGINT(MATHERROR)C_POINTER($1;$2)C_REAL($0)$0:=0  // Traitement des erreursCase of : (Size of array($1->)#Size of array($2->))MATHERROR:=-1: (Size of array($1->)=0)MATHERROR:=-2Else MATHERROR:=0End case   // AlgorithmeIf (MATHERROR=0)C_LONGINT($i;$k)C_REAL($mX;$mY)$mX:=0  // moyenne des x$mY:=0  // moyenne des y$k:=Size of array($1->)For ($i;1;$k)$mX:=$mX+$1->{$i}$mY:=$mY+$2->{$i}End for $mX:=$mX/$k$mY:=$mY/$k$0:=0For ($i;1;$k)  // somme des produits des ecarts valeur/moyenne$0:=$0+(($1->{$i}-$mX)*($2->{$i}-$mY))End for $0:=$0/$kEnd if 