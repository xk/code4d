If (False)  // MATH_INTPER [Antoine Galmiche 17/09/2004]  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // Calcule le montant des intérêts d'un investissement pour une période donnée,  // fondé sur des paiements périodiques et constants, et un taux d'intérêt fixe.  // ---------------------------------------------  // MATH_INTPER (taux; période; npm; va; {vc {; sélecteur}}) -> Intérêts  // taux (Numérique) taux d'intérêt par période  // période (Numérique) période considérée  // npm (Numérique) nombre total de périodes  // va (Numérique) capital emprunté  // vc (Numérique) valeur résiduelle  // sélecteur (Numérique) 1:échéance en début de période, 0:fin de période  // intérêts (Numérique) valeurs des intérêts à rembourser  // ---------------------------------------------  // MATHERROR  // 0 -> Pas d'erreur  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  // This method computes the amount of interests of an investment for a given period  // based on periodic and constant reimbursement, with a fixed interest rate.  // ---------------------------------------------  // MATH_INTPER (Rate; Period; npm; va; {vc {; Selector}}) -> Interest  // Rate (Real)        Interest rate by period  // Period (Real)     Period considered  // npm (Real)         Total number of periods  // va (Real)              Borrowed capital  // vc (Real)              Residual value  // Selector (Real)   1: due date at beginning of period, 0: at end of period  // Interests (Real)  Value of interests to reimburse  // ---------------------------------------------  // MATHERROR  //  0 -> No error  // ---------------------------------------------  //  (translation : BE 03-2010)End if   //@SVN_Folder: MATH_/C_LONGINT(MATHERROR)C_REAL($1;$2;$3;${4})C_REAL($0)C_REAL($n)C_LONGINT($k)MATHERROR:=0$0:=0Case of : (Count parameters<=4)$n:=0$k:=0: (Count parameters=5)$n:=$5$k:=0Else $n:=$5$k:=$6End case $0:=($1/(1+($k*$1)))*($4*((1-((1+$1)^(-$3+$2-1)))/((1+$1)^(-$3)-1))-($n*((1-((1+$1)^($2-1)))/(((1+$1)^$3)-1))))