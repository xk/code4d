  //A revoirIf (False)  // MATH_VAN_PAIEMENTS [Bernard Escaich 25/09/2005]  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // Calcule la valeur actuelle d'une série de flux financiers non constants  // et à dates variables  // ---------------------------------------------   // MATH_VAN_PAIEMENTS (taux; valeurs; dates) -> valeur  // Taux (Numérique) taux d'intérêt  // Valeurs (Tableau réel)   // Dates (Tableau date)  // ---------------------------------------------  // MATHERROR  //  0 -> Pas d'erreur  // -1 -> $1=-1 (division par zéro)  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  // This method computes actual value of a serie of non constant financial flow, at variable dates  // ---------------------------------------------  // MATH_VAN_PAIEMENTS (Rate; Values; Dates) -> Value  // Rate (Real) Interest rate  // Values (Real array)   // Dates (Date array)  // ---------------------------------------------  // MATHERROR  //  0 -> No error  // -1 -> $1=-1 (divide by zero)  // ---------------------------------------------  //  (translation : BE 03-2010)End if   //@SVN_Folder: MATH_/MATHERROR:=0C_REAL($1)C_POINTER(${2})C_REAL($0)C_LONGINT($i)$0:=0If ($1=-1)MATHERROR:=-1Else For ($i;1;Size of array($2->))$0:=$0+($2->{$i}/((1+$1)^(($3->{$i}-$3->{1})/365)))End for End if 