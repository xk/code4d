If (False)  //MATH_ObjetVersMatrice  //Auteur : Antoine Galmiche  //Date : 21/08/2002  //Basé sur MATH_TableauVersMatrice 30/07/2002  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // MATH_ObjetVersMatrice (->Objet; ->Tableau2D)  // Objet (voir ci-dessous) Objet à transformer en matrice régulière  // Objet peut être un Texte ou un Tableau2D Réel  // Tableau2D (Tableau réel 2D) Tableau matrice régulière  // C'est à dire en tableau 2D dont les lignes sont de même taille et les colonnes de même taille  // ----------------------------------  // MATHERROR  // 0 -> Pas d'erreur  // -1 -> Le texte n'est pas correctement formaté  // ----------------------------------  // ATTENTION  // Le texte doit être formaté ainsi :  // Suites de nombres réels, séparés par : pour les colonnes  // et ; pour les lignes.  // Ex "1:2:3;4:5" -> ligne 1 = 1 et 2 et 3, ligne 2 = 4 et 5  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  // MATH_ObjetVersMatrice (->Object; ->Array 2D)  // Object (see below) Object to transform in regular matrix  // Object may be a string or a real array 2D  // Array2D (Real Array 2D) Regular matrix array  // Thatis to say, an array 2D witch rows are same lenght dans columns are same lenght  // ----------------------------------  // MATHERROR  //  0 -> No error  // -1 -> Text is not ofrmatted properly  // ----------------------------------  // WARNING  // Text must be formatted as :  // Real number list, separated by colon for columns and by semi-colon for rows.  // Ex "1:2:3;4:5" -> row 1 = 1 et 2 et 3, row 2 = 4 et 5  // ------------------------------------------------------End if   //@SVN_Folder: MATH_/C_LONGINT(MATHERROR)MATHERROR:=0C_POINTER($1;$2)C_LONGINT($i;$j;$k;$jMax;$kMax)C_TEXT($virgule;$car)C_TEXT($nombre)C_TEXT($txt)ARRAY REAL($2->;0;0)  // matrice finaleCase of : (Type($1->)=Array 2D)For ($i;1;Size of array($1->))  // pour chaque ligne du tableau initialIf (Size of array($1->{$i})>$k)$k:=Size of array($1->{$i})  // $k est le nombre maximum de colonnesEnd if End for ARRAY REAL($2->;Size of array($1->);$k)  // matrice finaleFor ($i;1;Size of array($2->))For ($j;1;$k)If (Size of array($1->{$i})>=$j)  // copie des valeurs$2->{$i}{$j}:=$1->{$i}{$j}Else   // il faut remplir avec des zéros$2->{$i}{$j}:=0End if End for End for : (Type($1->)=Is Text)If ($1->="")MATHERROR:=-1  // texte vide = texte mal formaté !Else $virgule:=Substring(String(1/2);2;1)  // pas de problème si système américain$j:=0$jMax:=0$kMax:=1$nombre:=""ARRAY TEXT($tabtxt;0)$txt:=Replace string($1->;"::";":0:")$txt:=Replace string($txt;";;";";0;")$txt:=Replace string($txt;":;";":0;")$txt:=Replace string($txt;";:";";0:")For ($i;1;Length($txt))$car:=($txt)[[$i]]If (Position($car;"+-0123456789:;"+$virgule)=0)MATHERROR:=-1$i:=Length($txt)  // on sort de la boucleElse Case of : ($car=";")  // fin de ligne$kMax:=$kMax+1  // compte le nombre de lignes    $j:=0INSERT IN ARRAY($tabtxt;Size of array($tabtxt)+1)$tabtxt{Size of array($tabtxt)}:=$nombreINSERT IN ARRAY($tabtxt;Size of array($tabtxt)+1)$tabtxt{Size of array($tabtxt)}:=""  // ligne vide -> fin de ligne$nombre:="": ($car=":")  // fin de colonne$j:=$j+1  // compte le nb de colonne pour la ligne couranteINSERT IN ARRAY($tabtxt;Size of array($tabtxt)+1)$tabtxt{Size of array($tabtxt)}:=$nombre$nombre:=""If ($j>$jMax)$jMax:=$j  // plus grande qté de colonnesEnd if Else   // construisons le nombre$nombre:=$nombre+$carEnd case End if End for INSERT IN ARRAY($tabtxt;Size of array($tabtxt)+1)$tabtxt{Size of array($tabtxt)}:=$nombreIf (MATHERROR=0)ARRAY REAL($2->;$kMax;($jMax+1))  // matrice finale   $k:=1  // ligne courante$j:=1For ($i;1;Size of array($tabtxt))If ($tabtxt{$i}#"")$2->{$k}{$j}:=Num($tabtxt{$i})$j:=$j+1Else $k:=$k+1  // ligne suivante $j:=1  // première colonneEnd if End for End if End if End case 