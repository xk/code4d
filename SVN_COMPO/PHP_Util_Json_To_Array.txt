C_TEXT($1)C_POINTER($2;$3)ASSERT((Count parameters>0);Get localized string("a string was expected."))ASSERT((Count parameters>1);Get localized string("a pointer was expected."))ASSERT((Not(Nil($2)));Get localized string("the pointer is invalid."))ASSERT((Count parameters>2);Get localized string("a pointer was expected."))ASSERT((Not(Nil($3)));Get localized string("the pointer is invalid."))ASSERT(($2#$3);Get localized string("the arrays cannot be the same."))ARRAY LONGINT($match_position_al;0)ARRAY LONGINT($match_length_al;0)C_LONGINT($i)$i:=1Case of : (Type($3->)=Text array)  //%W-518.5ARRAY TEXT($2->;0)ARRAY TEXT($3->;0)  //%W+518.5While (Match regex("\"([^\"]+?)\":([\"]?)([^\"]*)\\2(,|\\})";$1;$i;$match_position_al;$match_length_al))APPEND TO ARRAY($2->;Substring($1;$match_position_al{1};$match_length_al{1}))APPEND TO ARRAY($3->;Substring($1;$match_position_al{3};$match_length_al{3}))$i:=$match_position_al{4}+$match_length_al{4}End while : (Type($3->)=LongInt array)  //%W-518.5ARRAY LONGINT($2->;0)ARRAY LONGINT($3->;0)  //%W+518.5While (Match regex("\"(.+?)\":(\"?)(.+?)\\2(,|\\})";$1;$i;$match_position_al;$match_length_al))APPEND TO ARRAY($2->;Num(Substring($1;$match_position_al{1};$match_length_al{1})))APPEND TO ARRAY($3->;Num(Substring($1;$match_position_al{3};$match_length_al{3})))$i:=$match_position_al{4}+$match_length_al{4}End while End case 