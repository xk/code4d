If (False)  // MATH_Variance [Teddy Linet 23/07/02] v1.0  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // Calcul de la variance : honteusement copiée et librement modifié de EcartType  // Intérêt ultérieur pour les calculs statistiques demandant la variance et non  // l' écart type (évite un "EcartType^2" dans un but d'optimisation des méthodes)  // ---------------------------------------------  // MATH_Variance (->Tableau) -> Numérique  // Tableau (Pointeur) Liste dont on cherche la variance  // Résultat (Numérique) Variance  // ---------------------------------------------  // MATHERROR  //  0 -> Pas d'erreur  // -1 -> Tableau nul  //  1 -> Tableau avec 1 élément  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  // Variance calculation: copied on EcartType (standard deviation)  // This method present a later interest  for statistical calculations asking variance and not  // standard deviation (it avoids "StdDeviation^2" to optimize methods)  // ---------------------------------------------  // MATH_Variance (->Array) -> Real  // Array (Pointer) List from which we look for variance  // Result (Real) Variance  // ---------------------------------------------  // MATHERROR  // 0 -> No error  // -1 -> Empty array  //  1 -> Array with one element  // ------------------------------------------------------  //  (translation : BE 03-2010)End if   //@SVN_Folder: MATH_/C_LONGINT(MATHERROR)C_POINTER($1)C_REAL($0)C_REAL($x2;$x)C_LONGINT($i;$k)$k:=Size of array($1->)$x2:=0$x:=0Case of : ($k=0)  // Blurp ! tableau nulMATHERROR:=-1: ($k=1)  // Variance sur un élément => attention à la cohérence !MATHERROR:=1Else MATHERROR:=0End case If (MATHERROR=0)For ($i;1;$k)$x2:=$x2+($1->{$i}^2)  // Somme(x2)$x:=$x+$1->{$i}  // Somme(x)End for   // Variance = Somme(x^2)/n - (Somme(x)/n)^2  $0:=$k*$x2  // nSomme(x2)$0:=$0-($x^2)  // nSomme(x2) - (Somme(x))2$0:=$0/($k^2)  // (nSomme(x2) - (Somme(x))2) / n2Else   // Retourne 0 si pas calculable$0:=0  //  NB la variance est nulle pour un tableau à 1 élémentEnd if 