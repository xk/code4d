If (False)  //MATH_Amortissements   //Auteur : Marc Duc-Jacquet  //Date : 2006  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // Calcule le tableau d'amortissement d'un emprunt  // ---------------------------------------------  // MATH_Amortissements (i; N; C; PtrArr1;PtrArr2;PtrArr3)   // i (Numérique) taux d'intérêt sur la période  // N (Numérique) nombre  d'échéances  // C (Numérique) capital emprunté  // PtrArr1 : pointeur vers un  tableau à N lignes: intérêts versés lors de chacune des échéances  // PtrArr2 : pointeur vers un  tableau à N lignes:capital remboursé lors de chacune des échéances  // PtrArr2 : pointeur vers un  tableau à N lignes:capital restant dû après l' échéance précédente  // ---------------------------------------------  // MATHERROR  //   0 -> Pas d'erreur  // -1 -> Paramètres hors bornes  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  //This method computes depreciation area of a loan  // ---------------------------------------------  // MATH_Amortissements (i; N; C; PtrArr1;PtrArr2;PtrArr3)   // i (Real)    interest rate on period  // N (Real)  number of payments  // C (Real)  borrowed capital   // PtrArr1 : pointer to an array with N rows: interests payed at each payment  // PtrArr2 : pointer to an array with N rows: reimbursed capital at each payment  // PtrArr2 : pointer to an array with N rows: capital due after previous payment  // ---------------------------------------------  // MATHERROR  //   0 -> No error  // -1 -> Out of ranges parameters  // ---------------------------------------------  //  (translation : BE 03-2010)End if   //@SVN_Folder: MATH_/C_LONGINT(MATHERROR)C_REAL($1;$2;$3)C_POINTER($4;$5;$6)MATHERROR:=0ARRAY REAL($Tab1;$2)ARRAY REAL($Tab2;$2)ARRAY REAL($Tab3;$2)$1:=$1/100MATHERROR:=-1Case of : (((1+$1)^$2)=0): ((1-(1/((1+$1)^$2)))=0)Else MATHERROR:=0$A:=($3*$1)/(1-(1/((1+$1)^$2)))  // montant total remboursé à chaque périodeEnd case If (MATHERROR=0)$Tab1{0}:=0$Tab2{0}:=0$Tab3{0}:=$3For ($k;1;$2)$Tab1{$k}:=$Tab3{$k-1}*$1$Tab2{$k}:=$A-$Tab1{$k}$Tab3{$k}:=$Tab3{$k-1}-$Tab2{$k}End for   //affectation resultatsFor ($k;1;$2)$4->{$k}:=Round($Tab1{$k};2)$5->{$k}:=Round($Tab2{$k};2)$6->{$k}:=Round($Tab3{$k};2)End for $0:=$AEnd if 