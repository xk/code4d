  `This method is part from Math4D project 2002-2010 with authors : Jacques Bossy, Philip Burns, Olivier Deschanels, Marc Duc-Jacquet  `Bernard Escaich, Antoine Galmiche, Micaël Germann, George F. Huhn, Nicolas Jore, Teddy Linet, Frédéric Quoirez, Michel Saiz, Robert Van Loo  `If (False)  ` MTH_STA_LinearRegression (was MATH_RegressionLineaire) [Antoine Galmiche 04/2002]  ` ------------------------------------------------------  ` ---------------   E N G L I S H   -----------------  ` ------------------------------------------------------  `Math's summary  ` Linear regression line represents the smoothing of a cloud of points by a line  ` ---------------------------------------------  ` MATH_RegressionLineaire(->ArrayX ;->ArrayY ;->ResultArray)  ` ArrayX (Pointer) Pointer on real abscissas array that must be sorted  ` ArrayY (Pointer) Pointer on real ordinates array  ` ResultArray (Pointer) Pointer on array of points of the line of regression      ` Coefficients A and B of the line y=Ax + B are placed like this :  ` A in ArrayX{0} et B in ArrayY{0}  ` ---------------------------------------------  ` MATHERROR  `   0 -> No error  ` -1 -> Abscissas not sored  ` -2 -> Arrays with different lengthes  ` ------------------------------------------------------  ` ---------------   F R A N C A I S  ---------------  ` ------------------------------------------------------  ` Rappels mathématiques :  ` La droite de régression linéaire représente le lissage par   ` une droite d'un nuage de points  ` ---------------------------------------------  ` MATH_RegressionLineaire(->TableauX ;->TableauY ;->TableauRésultat)  ` TableauX (Pointeur) Pointeur tableau réel des abscisses qui doivent être triés  ` TableauY (Pointeur) Pointeur tableau réel des ordonnées  ` TableauRésultat (Pointeur) Pointeur tableau points de la droite de régression  ` Les coefficients A et B de la droite y=Ax + B sont placés ainsi :  ` A dans TableauX{0} et B dans TableauY{0}  ` ---------------------------------------------  ` MATHERROR  ` 0 -> Pas d'erreur  ` -1 -> Abscisses non triées  ` -2 -> Tableaux de tailles différentes  ` ------------------------------------------------------  `  (translation : BE 03-2010)End if C_LONGINT(MATHERROR)C_POINTER($1;$2;$3;$4)  ` tab abscisses ; tab ordonnées ; tab droiteIf (False)C_POINTER(MTH_STA_LinearRegression ;$1)C_POINTER(MTH_STA_LinearRegression ;$2)C_POINTER(MTH_STA_LinearRegression ;$3)C_POINTER(MTH_STA_LinearRegression ;$4)End if C_LONGINT($k;$i)C_REAL($test;$b0;$b1)MATHERROR:=0$k:=Size of array($1->)If ($k#0)$test:=$1->{1}For ($i;2;$k)If ($test>($1->{$i}))MATHERROR:=-1$i:=$kElse $test:=$1->{$i}End if End for If (Size of array($2->)#$k)MATHERROR:=-2End if If (MATHERROR=0)ARRAY REAL($tab;$k)  ` résultat    C_REAL($x2;$y;$x;$xy)$x2:=0$y:=0$x:=0$xy:=0For ($i;1;$k)$x2:=$x2+($1->{$i}^2)  ` Somme(x2)$y:=$y+$2->{$i}  ` Somme(y)$x:=$x+$1->{$i}  ` Somme(x)$xy:=$xy+($1->{$i}*$2->{$i})  ` Somme(xy)End for   ` calcul du b0 dans y = b0 + b1x$b0:=((($x2*$y)-($x*$xy))/(($k*$x2)-($x^2)))$b1:=((($k*$xy)-($x*$y))/(($k*$x2)-($x^2)))For ($i;1;$k)$tab{$i}:=$b0+(($1->{$i})*$b1)End for COPY ARRAY($tab;$3->)$1->{0}:=$b1$2->{0}:=$b0End if End if 