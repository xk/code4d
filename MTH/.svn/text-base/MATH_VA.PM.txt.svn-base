If (False)  // MATH_VA [Antoine Galmiche 17/09/2004]  // ------------------------------------------------------  // ---------------   F R A N C A I S  ---------------  // ------------------------------------------------------  // Calcule la valeur actuelle d'un investissement  // ---------------------------------------------  // MATH_VA (taux; npm; vpm{{; vc}; sélecteur}) -> valeur  // taux (Numérique) taux d'intérêt  // npm (Numérique) nombre de périodes  // vpm (Numérique) valeur d'un paiement pour une période  // vc (Numérique) valeur résiduelle  // sélecteur (Numérique) 1:échéance en début, 0:échéance en fin  // valeur (Numérique) va  // ---------------------------------------------  // MATHERROR  //  0 -> Pas d'erreur  // -1 -> taux nul  // ------------------------------------------------------  // ---------------   E N G L I S H   -----------------  // ------------------------------------------------------  // This method computes actual value of an investment  // ---------------------------------------------  // MATH_VA (Rate; npm; vpm{{; vc}; Selector}) -> Value  // Rate (Real)        Interest rate  // npm (Real)         number of periods  // vpm (Real)         payment amount for a period  // vc (Real)             residual value  // Selector (Real)  1: due date at beginning of period, 0: at end of period  // Value (Real)      va  // ---------------------------------------------  // MATHERROR  //  0 -> No error  // -1 -> Rate = zero  // ---------------------------------------------  //  (translation : BE 03-2010)End if   //@SVN_Folder: MATH_/C_LONGINT(MATHERROR)MATHERROR:=0C_REAL($1;$2;${3})C_REAL($0)C_REAL($n)C_LONGINT($k)$0:=0If ($1=0)MATHERROR:=-1Else Case of : (Count parameters<=3)$n:=0$k:=0: (Count parameters=4)$n:=$4$k:=0Else $n:=$4$k:=$5End case $0:=(-$3*(1+($1*$k))*(1-((1+$1)^(-$2)))/$1)-($n*((1+$1)^(-$2)))End if 