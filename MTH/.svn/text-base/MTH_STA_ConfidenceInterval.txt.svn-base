  `This method is part from Math4D project 2002-2010 with authors : Jacques Bossy, Philip Burns, Olivier Deschanels, Marc Duc-Jacquet  `Bernard Escaich, Antoine Galmiche, Micaël Germann, George F. Huhn, Nicolas Jore, Teddy Linet, Frédéric Quoirez, Michel Saiz, Robert Van Loo If (False)  ` MTH_STA_ConfidenceInterval (was MATH_IntervalleConfiance) [Teddy LINET 08/2002]  ` ------------------------------------------------------  ` ---------------   E N G L I S H   -----------------  ` ------------------------------------------------------  ` WARNING : This method needs MATH_LoiNormale  ` ---------------------------------------------  `Math's summary  ` A confidence interval of a proportion (Po) or of an experimental mean  ` (x) allows to give interval or TRUE proportion or TRUE mean  ` may be found with risk alpha (usually 0,05)  `   ` For a proportion, confidence interval (IC) with level 1-alpha  ` (or at risk alpha) can be computed with formula :  `                                                          Po(1-Po)  ` IC = [pmin ; pmax] = Po +- Ualpha Sqr----------  `                                                                n  ` Conditions are :  ` n x pmin >= 5 AND n x (1-pmax) >= 5  `  ` For a mean, interval may be computed with formula   `                             s  ` IC = x +- Ualpha  -----  `                           Sqr(n)  ` Conditions are : n >= 30  ` ---------------------------------------------  ` Two syntaxes :  `1) MATH_IntervalleConfiance (CalculationType; Proportion; Alpha; NbElements)  ` CalculationType (Integer) : 1 for proportion, or constant Confiance_Proportions  ` Proportion (Real) : Experimental proportion (Po)  ` Alpha (Real) : Risk alpha (usually 0,05)  ` NbElements (Entier Long) : Nombre of elements in experimental serie  ` Returns $0 (Real)  representing half of interval, ie  ` IC = [Proportion-$0 ; Proportion+$0]  `   `2) MATH_IntervalleConfiance (TypeDeCalcul; Mean; Alpha; NbIndividus; EType)  ` TypeDeCalcul (Integer) : 2 for mean, or constant Confiance_Mean  ` Mean (Real) : Experimental mean (x)  ` Alpha (Real) : Risque alpha (usually 0,05)  ` NbIndividus (Longinteger) : Number of elements in experimental serie  ` EType (Real) : Standard deviation of serie  ` Returns $O (Real)  representing half of interval, ie  ` IC = Mean-$0 ; Mean+$0]  ` ---------------------------------------------  ` MATHERROR  `   0 -> No error  `  -1 -> n <= 0  `  -2 -> Alpha is not a proportion (not between 0 and 1)  `  -3 -> Proportion not possible (not between 0 and 1)  ` +1 -> Conditions not fulfilled  ` +2 -> Negative standard deviation (turned to positive) or nil  ` ---------------------------------------------  ` EXEMPLES  ` MATH_Moyennes (Confiance_Proportions ;0,1;0,05;100)  ` Returns 0,06 and MATHERROR = 1 (why 100 x 0,4 = 4)  ` ------------------------------------------------------  ` ---------------   F R A N C A I S  ---------------  ` ------------------------------------------------------  ` ATTENTION : Nécessite MATH_LoiNormale  ` ---------------------------------------------  ` Rappels mathématiques :  ` Un intervalle de confiance d'une proportion (Po) ou d'une moyenne expérimentale  ` (x) permet de donner l'intervalle ou la proportion VRAIE ou la moyenne VRAIE  ` peut se trouver avec le risque alpha (habituellement 0,05)  `   ` Pour une proportion l'intervalle de confiance (IC) de niveau 1-alpha  ` (ou au risque alpha) peut se calculer selon la formule :  `                                                          Po(1-Po)  ` IC = [pmin ; pmax] = Po +- Ualpha Sqr----------  `                                                                n  ` Les conditions sont :  ` n x pmin >= 5 ET n x (1-pmax) >= 5  `  ` Pour une moyenne l'intervalle peut se calculer selon la formule  `                             s  ` IC = x +- Ualpha  -----  `                           Sqr(n)  ` Les conditions sont : n >= 30  ` ---------------------------------------------  ` Deux écritures :  `   ` MATH_IntervalleConfiance (TypeDeCalcul; Proportion; Alpha; NbIndividus)  ` TypeDeCalcul (Entier) : 1 pour proportion, ou constante Confiance_Proportions  ` Proportion (Réel) : Proportion expérimentale (Po)  ` Alpha (Réel) : Risque alpha (habituellement 0,05)  ` NbIndividus (Entier Long) : Nombre d'individus dans la série expérimentale  ` Renvoie $O (Réel)  représentant la moitié de l'intervalle d'amplitude soit  ` IC = [Proportion-$0 ; Proportion+$0]  `   ` MATH_IntervalleConfiance (TypeDeCalcul; Moyenne; Alpha; NbIndividus; EType)  ` TypeDeCalcul (Entier) : 2 pour moyenne, ou constante Confiance_Moyenne  ` Moyenne (Réel) : Moyenne expérimentale (x)  ` Alpha (Réel) : Risque alpha (habituellement 0,05)  ` NbIndividus (Entier Long) : Nombre d'individus dans la série expérimentale  ` EType (Reel) : Ecart-type de la série  ` Renvoie $O (Réel)  représentant la moitié de l'intervalle d'amplitude soit  ` IC = [Moyenne-$0 ; Moyenne+$0]  ` ---------------------------------------------  ` MATHERROR  `  0 -> Pas d'erreur  `  -1 -> n <= 0  `  -2 -> Alpha n'est pas une proportion (pas entre 0 et 1)  `  -3 -> Proportion impossible (pas entre 0 et 1)  ` +1 -> Conditions non remplies  ` +2 -> Ecart-type négatif (mis à positif) ou nul  ` ---------------------------------------------  ` EXEMPLES  ` MATH_Moyennes (Confiance_Proportions ;0,1;0,05;100)  ` Renvoie 0,06 et MATHERROR = 1 (car 100 x 0,4 = 4)  ` ------------------------------------------------------  `  (translation : BE 3-2010)End if C_REAL($0;$2;$vProportion_F;$vMoyenne_F;$3;$vAlpha_F;$5;$EType_F)C_LONGINT($1;$vOptionCalcul_L)C_LONGINT($4;$vNbIndividus_L)C_LONGINT(MATHERROR)$vOptionCalcul_L:=$1$vProportion_F:=$2$vMoyenne_F:=$2  ` La même chose, mais on améliore la lisibilité$vAlpha_F:=$3$vNbIndividus_L:=$4If (Count parameters=5)$EType_F:=$5End if MATHERROR:=0  ` Pas d'erreur pour l'instant$0:=0  ` Par défautIf (False)C_REAL(MTH_STA_ConfidenceInterval ;$0)C_LONGINT(MTH_STA_ConfidenceInterval ;$1)C_REAL(MTH_STA_ConfidenceInterval ;$2)C_REAL(MTH_STA_ConfidenceInterval ;$3)C_LONGINT(MTH_STA_ConfidenceInterval ;$4)C_REAL(MTH_STA_ConfidenceInterval ;$5)End if Case of : ($vNbIndividus_L<1)  ` Gloups, pas d'individusMATHERROR:=-1: (($vAlpha_F<0) | ($vAlpha_F>1))  ` Alpha n'est pas une proportionMATHERROR:=-2End case If (MATHERROR=0)  ` Tout est bonIf ($vOptionCalcul_L=1)  ` Première partie, calcul en fonction des proportionsIf (($vProportion_F>1) | ($vProportion_F<0))  ` Gloups, pas une proportionMATHERROR:=-3End if If (MATHERROR=0)  ` Tout est bon$0:=$vProportion_F*(1-$vProportion_F)$0:=$0/$vNbIndividus_L$0:=Square root($0)$0:=MTH_STA_StandardDistribution ($vAlpha_F;"Z")*$0  ` Calcul réaliséIf ((($vNbIndividus_L*($vProportion_F-$0))<5) | (($vNbIndividus_L*(1-($vProportion_F+$0)))<5))MATHERROR:=1  ` Les conditions ne sont par rempliesEnd if End if Else   ` Deuxième option, calcul en fonction d'une moyenneCase of : ($vNbIndividus_L<30)MATHERROR:=1  ` Les conditions ne sont par remplies: ($EType_F<=0)MATHERROR:=2  ` L'écart-type doit être positif (non nul pour la cohérence)$EType_F:=Abs($EType_F)End case If (MATHERROR>=0)  ` Tout est bon$0:=Square root($vNbIndividus_L)$0:=$EType_F/$0$0:=MTH_STA_StandardDistribution ($vAlpha_F;"Z")*$0End if End if End if 