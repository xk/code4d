C_POINTER($1;$2)  ` pointeur tableaux réels DE MEME TAILLEC_REAL($0)  ` coefficient de correlation$0:=MTH_STA_CorrelationCoefficient ($1;$2)If (False)  `MATH_CoefficientCorrelation   `Auteur : Antoine Galmiche  `Date : 07/2002  ` ------------------------------------------------------  ` ---------------   F R A N C A I S  ---------------  ` ------------------------------------------------------  ` Rappels mathématiques :  ` CC = Covariance / (EcartType(X).EcartType(Y))  ` Le coeff. de corr. est le quotient de la covariance de deux séries  ` par le produit de leurs écarts types.  ` Il est compris entre -1 et +1  ` et il mesure l'indépendance des deux séries l'une par rapport à l'autre  ` Si CC=0, elles sont indépendantes  ` Si CC=1 ou -1, il existe une relation entre elles  `http://fr.wikipedia.org/wiki/Corrélation_(statistiques)  ` ---------------------------------------------  ` MATH_CoefficientCorrelation (->TableauValeurs1; ->TableauValeurs2) -> Numérique  ` TableauValeurs1 (Pointeur) Pointeur tableau réel de la série 1  ` TableauValeurs2 (Pointeur) Pointeur tableau réel de la série 2  ` Résultat (Numérique) Coefficient de correlation  ` ---------------------------------------------  ` MATHERROR  ` 0 -> Pas d'erreur  ` -1 -> Tableaux de taille différente  ` -2 -> Tableaux de taille nulle  ` ---------------------------------------------  ` EXEMPLES  ` Le CC entre {1,2,3,4} et {5,6,7,8} est 1  ` Le CC entre {1,2,3,4} et {8,7,6,5} est -1  ` Le CC entre {1,2,3,4} et {7,5,8,6} est 0  ` ------------------------------------------------------  ` ---------------   E N G L I S H   -----------------  ` ------------------------------------------------------  `Math's summary  ` CC = Covariance / (StandardDeviation(X).StandardDeviation(Y))  ` Correlation coefficient is quotient of covariance of two series by product of their standard deviation  ` It is contained between -1 and +1  ` and measures independance of the 2 series, one in relation to other  ` If CC=0, they are independant  ` If CC=1 ou -1, there is a relation between them  `http://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient  ` ---------------------------------------------  ` MATH_CoefficientCorrelation (->ValuesArray1; ->ValuesArray2) -> Real  ` ValuesArray1 (Pointer) Pointer on real array of  serie 1  ` ValuesArray2 (Pointer) Pointer on real array of  serie 2  ` Result (Real) Correlation coefficient  ` ---------------------------------------------  ` MATHERROR  `  0 -> No error  ` -1 -> Arrays with different lenght  ` -2 -> Empty arrays  ` ---------------------------------------------  ` EXAMPLES  ` CC between {1,2,3,4} and {5,6,7,8} is 1  ` CC between {1,2,3,4} and {8,7,6,5} is -1  ` CC between {1,2,3,4} and {7,5,8,6} is 0  ` ------------------------------------------------------  `  (translation : BE 03-2010)  `End if C_LONGINT(MATHERROR)C_POINTER($1;$2)  ` pointeur tableaux réels DE MEME TAILLEC_REAL($0)  ` coefficient de correlation$0:=0  ` Traitement des erreursCase of : (Size of array($1->)#Size of array($2->))MATHERROR:=-1: (Size of array($1->)=0)MATHERROR:=-2Else MATHERROR:=0End case   ` AlgorithmeIf (MATHERROR=0)C_LONGINT($i;$k)C_REAL($x2;$x;$y2;$y;$mX;$mY;$etX;$etY)$x2:=0  ` ∑x2$x:=0  ` ∑x$y2:=0  ` ∑y2$y:=0  ` ∑y$mX:=0  ` moyenne des x$mY:=0  ` moyenne des y$k:=Size of array($1->)For ($i;1;$k)$mX:=$mX+$1->{$i}$mY:=$mY+$2->{$i}$x2:=$x2+($1->{$i}^2)  ` ∑x2$x:=$x+$1->{$i}  ` ∑x$y2:=$y2+($2->{$i}^2)  ` ∑y2$y:=$y+$2->{$i}  ` ∑yEnd for $mX:=$mX/$k  ` calcul des moyennes$mY:=$mY/$k$0:=0  ` 1er calcul : la covarianceFor ($i;1;$k)  ` somme des produits des ecarts valeur/moyenne$0:=$0+(($1->{$i}-$mX)*($2->{$i}-$mY))End for $0:=$0/$k  ` à ce niveau, $0 = covariance  ` 2ème calcul : les écarts type$etX:=$k*$x2  ` n∑x2$etX:=$etX-($x^2)  ` n∑x2 - (∑x)2$etX:=$etX/($k^2)  ` (n∑x2 - (∑x)2) / n2$etX:=Square root($etX)  ` √( (n∑x2 - (∑x)2) / n2 )$etY:=$k*$y2$etY:=$etY-($y^2)$etY:=$etY/($k^2)$etY:=Square root($etY)$0:=$0/($etX*$etY)  ` CC=covariance / ecarttype(X).ecarttype(Y)End if End if 