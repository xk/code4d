C_REAL($0;$1;$2)  ` Bornes inclusesC_POINTER(${3})  ` pointeur tableau ?If (Count parameters>=3)  ` il y a un ptr$0:=MTH_NBR_Random ($1;$2;$3)Else $0:=MTH_NBR_Random ($1;$2)End if If (False)  ` MATH_Hasard [Antoine Galmiche 12/9/02,25/2/03]  ` ------------------------------------------------------  ` ---------------   F R A N C A I S  ---------------  ` ------------------------------------------------------  ` ATTENTION : Méthode récursive  ` ---------------------------------------------  ` MATH_Hasard (Mini;  Maxi {; PtrTableau} ) -> Réel  ` Début (Réel) Valeur minimum qui peut être négative  ` Maxi (Réel) Valeur maxi qui peut être négative  ` PtrTableau (Pointeur tableau réels) Tableau de valeurs (optionnel)  ` Résultat (Réel) Valeur hasard entre Mini et Maxi  ` Les valeurs sont des réels, elles peuvent donc dépasser 32767  ` Si Mini=Maxi=0, la valeur retournée est un réel compris entre 0 et 1  ` Le tableau optionnel doit être défini  ` Si le tableau contient déjà des valeurs, il contient les mêmes valeurs  ` après exécution, mais dans le désordre  ` Si le tableau est rempli de 0, il est retourné rempli de valeurs aléatoires  ` comprises entre Mini et Maxi  ` Si la tableau est défini mais sans lignes, il est retourné inchangé  ` Dans tous les cas, la méthode retourne un nombre aléatoire  ` compris entre Mini et Maxi  ` ---------------------------------------------  ` MATHERROR  ` 0 -> Pas d'erreur  ` -1 -> Maxi inférieur au Mini  ` ---------------------------------------------  ` EXEMPLES  ` TABLEAU ENTIER LONG(vtab;10)  ` $hasard:=MATH_Hasard (-100;100;->vtab)  ` > $hasard décimal compris entre -100 et +100 inclus  ` > vtab est rempli d'aléatoires décimaux compris entre -100 et +100 inclus  ` $hasard:=MATH_Hasard (0;0;->vtab)  ` > $hasard décimal compris entre 0 et 1 inclus  ` > vtab est mélangé  `   ` $hasard:=MATH_Hasard(-1000000000;1000000000)  ` > $hasard est compris entre - 1 milliard et + 1 milliard  ` ------------------------------------------------------  ` ---------------   E N G L I S H   -----------------  ` ------------------------------------------------------  ` WARNING : Recursiv method  ` ---------------------------------------------  ` MATH_Hasard (Mini;  Maxi {; PtrArray} ) -> Real  ` Mini (Real) Minimum value which may be negative  ` Maxi (Real) Maximum value which may be negative  ` PtrTableau (Pointer Real Array) Value array (optional)  ` Result (Real) Random value Mini between and Maxi  ` Values are real : they may be greater than 32767  ` If Mini=Maxi=0, returned value is a real between 0 and 1  ` Optional array must be defined  ` If array contains already values, it contains the same values after execution, but in random order  ` If array contains values zero, it is filled with random values between Mini and Maxi  `If array is defined but empty, it is returned unchanged  `In all occurences, méthod returns a random value between Mini and Maxi  ` ---------------------------------------------  ` MATHERROR  ` -0 -> No error  ` -1 -> Maxi smaller than Mini  ` ---------------------------------------------  ` EXAMPLES  ` TABLEAU ENTIER LONG(vtab;10)  ` $hasard:=MATH_Hasard (-100;100;->vtab)  ` > $hasard decimal between -100 et +100 included  ` > vtab is filled with decimals between -100 et +100 included  ` $hasard:=MATH_Hasard (0;0;->vtab)  ` > $hasard decimal between entre 0 et 1 included  ` > vtab is mixed up  `   ` $hasard:=MATH_Hasard(-1000000000;1000000000)  ` > $hasard is between - 1 milliard et + 1 milliard  ` ---------------------------------------------  `  (translation : BE 3-2010)  `End if C_LONGINT(MATHERROR)MATHERROR:=0C_REAL($0;$1;$2)  ` Bornes inclusesC_POINTER(${3})  ` pointeur tableau ?If ($2<$1)MATHERROR:=-1End if If (MATHERROR=0)C_REAL($i;$j;$k)C_BOOLEAN($bOK)$k:=(Milliseconds%(32768-10+1))+10For ($i;1;$k)$j:=RandomEnd for If (($1=0) & ($2=0))  ` inf = sup = 0$j:=0$k:=32767$i:=$k-$j$0:=$j+(Int(((Random/32768)*$i)+1))$0:=$0/32767Else $j:=$1-1$k:=$2If ($2=MAXLONG )$2:=$2-1End if $i:=$k-$j$0:=$j+(Int(((Random/32768)*$i)+1))End if If (Count parameters=3)  ` il y a un ptrIf (Size of array($3->)#0)  ` il y a des lignes$j:=Size of array($3->)ARRAY REAL($tab1;$j)ARRAY REAL($tab2;$j)For ($i;1;$j)  ` remplir le tableau 1$tab1{$i}:=$3->{$i}If ($tab1{$i}#0)$bOK:=True  ` un seul élément non nul et $bOK est vraiEnd if End for If ($bOK)  ` il n'y a pas que des zéros  For ($i;1;$j)$k:=MATH_Hasard (1;Size of array($tab1))$tab2{$i}:=$tab1{$k}DELETE FROM ARRAY($tab1;$k)End for Else   ` il n'y a que des zéros, remplir d'aléatoiresFor ($i;1;$j)$tab2{$i}:=MATH_Hasard ($1;$2)End for End if COPY ARRAY($tab2;$3->)End if End if End if End if 