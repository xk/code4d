C_REAL($1;$2;$3;$4)C_POINTER($5;$6;$7)If (False)  ` MATH_Echeance [Marc Duc-Jacquet, 2006]  ` ------------------------------------------------------  ` ---------------   F R A N C A I S  ---------------  ` ------------------------------------------------------  ` Calcule les éléments d'une échéance  ` ---------------------------------------------  ` MATH_Echéance (i;  N; C; echeance; Ptr1;Ptr2;Ptr3)   ` i (Numérique)                  taux d'intérêt   ` N (Numérique)                nombre total de périodes  ` C (Numérique)                capital emprunté  ` echeance (Numérique) numéro d'échéance  ` Ptr1 (Pointeur) vers variable interets (Numerique) :                 intétets payés lors de l'échéance considérée  `  Ptr2 (Pointeur) vers variable amortissement (Numerique) : capital remboursé lors de l'échéance considérée  ` Ptr3 (Pointeur) vers variable  reste dû (Numerique) :               capital restant dû après l'échéance  ` ---------------------------------------------  ` MATHERROR  `  0 -> Pas d'erreur  ` -1 -> Paramètres hors bornes  ` ------------------------------------------------------  ` ---------------   E N G L I S H   -----------------  ` ------------------------------------------------------  ` This method computes payment elements of a maturity  ` ---------------------------------------------  ` MATH_Echéance (i;  N; C; due date; Ptr1;Ptr2;Ptr3)   ` i (Real)                  interest rate  ` N (Real)                total number of periods  ` C (Real)                Borrowed capital   ` Payment (Real)   payment number  ` Ptr1 (Pointer)to interest variable (Real) :            interest paid at due date  `  Ptr2 (Pointer) to depreciation variable (Real) :   capital reimbursed at due date  ` Ptr3 (Pointer) to remainder variable  (Real) :      capital remainder  after due date  ` ---------------------------------------------  ` MATHERROR  `  0 -> No error  ` -1 -> Parameters out of range  ` ---------------------------------------------  `  (translation : BE 03-2010)End if C_LONGINT(MATHERROR)C_REAL($1;$2;$3;$4)C_POINTER($5;$6;$7)C_REAL($n)C_LONGINT($k)ARRAY REAL($Tab1;$2)ARRAY REAL($Tab2;$2)ARRAY REAL($Tab3;$2)$1:=$1/100MATHERROR:=-1Case of : (((1+$1)^$2)=0): ((1-(1/((1+$1)^$2)))=0)Else MATHERROR:=0$A:=($3*$1)/(1-(1/((1+$1)^$2)))  ` montant total remboursé à chaque périodeEnd case If (MATHERROR=0)$Tab1{0}:=0$Tab2{0}:=0$Tab3{0}:=$3For ($k;1;$2)$Tab1{$k}:=$Tab3{$k-1}*$1$Tab2{$k}:=$A-$Tab1{$k}$Tab3{$k}:=$Tab3{$k-1}-$Tab2{$k}End for $5->:=$Tab1{$4}$6->:=$Tab2{$4}$7->:=$Tab3{$4}End if 